"""
{{.ServiceName}} Router
Generated by bffgen
"""

from fastapi import APIRouter, HTTPException, Depends
{{if .Async}}
import httpx
{{else}}
import requests
{{end}}
from typing import Dict, Any, Optional
import logging

from config import settings
from services.{{.ServiceNameLower}}_service import {{.ServiceNameCamel}}Service

logger = logging.getLogger(__name__)

router = APIRouter(
    prefix="/api/{{.ServiceNameLower}}",
    tags=["{{.ServiceName}}"]
)

# Service instance
service = {{.ServiceNameCamel}}Service()

{{range .Endpoints}}
@router.{{.Method}}("{{.Path}}")
{{if $.Async}}async {{end}}def {{.FunctionName}}({{if .HasBody}}data: Dict[str, Any]{{end}}):
    """
    {{.Description}}
    """
    try:
        {{if $.Async}}
        result = await service.{{.FunctionName}}({{if .HasBody}}data{{end}})
        {{else}}
        result = service.{{.FunctionName}}({{if .HasBody}}data{{end}})
        {{end}}
        return result
    except Exception as e:
        logger.error(f"Error in {{.FunctionName}}: {str(e)}")
        raise HTTPException(status_code=500, detail=str(e))
{{end}}

